---
title: "How miRNA - target distance influences their regulation?"
date: 2021-05-28
author:
   - "Luca Csabai, Benedek Dankó, Sophie Farkas, Ágnes Takács"
output:
  ioslides_presentation:
    widescreen: true
    smaller: true
---

<style>
div.footnotes {
  position: absolute;
  bottom: 0;
  margin-bottom: 10px;
  width: 80%;
  font-size: 0.6em;
}
</style>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script>
$(document).ready(function() {
  $('slide:not(.backdrop):not(.title-slide)').append('<div class=\"footnotes\">');

  $('footnote').each(function(index) {
    var text  = $(this).html();
    var fnNum = (index+1).toString();
    $(this).html(fnNum.sup());

    var footnote   = fnNum + '. ' + text + '<br/>';
    var oldContent = $(this).parents('slide').children('div.footnotes').html();
    var newContent = oldContent + footnote;
    $(this).parents('slide').children('div.footnotes').html(newContent);
  });
});
</script>


## Questions to answer

- How does the distance between the miRNA gene and the target's gene affects their regulation?
- What are the specificities of the miRNA - targets interaction network?

## Introduction - miRNAs
```{r, out.width = "600px", echo=FALSE, fig.align="center"}
knitr::include_graphics("../docs/miRNA_schematic.gif")
```


## Dataset

- Human miRNA - target interaction database<footnote>Plotnikova, Olga, Ancha Baranova, and Mikhail Skoblov. "Comprehensive Analysis of Human microRNA–mRNA Interactome" Frontiers in Genetics 10 (2019):933. https://doi.org/10.3389/fgene.2019.00933 </footnote> downloaded from Exp-miBR (in `.tsv` format): experimentally confirmed miRNA binding regions and their features included too 
- Column names: `CHROM`, `start_Ref38`, `end_Ref38`, `length`, `STRAND`, `NDATASET`, `DATASET`, `NLINES`, `LINES`, `MIRNA`, `REGION`, `GENES`
- 46,740 rows, many `NA` values, miRNA IDs and target gene IDs often in one row, separated by commas

## Chromosome length versus number of miRNAs - Arrange text annotation automatically

```{r, eval=FALSE}
# Plot the length of the chromosome vs. number of miRNAs:
cor_plot <- ggplot(chr_info, aes(x=V2, y=count,label = V1))+
  geom_point(size=3)+
  ### <b>
  ggrepel::geom_text_repel()+
  ### </b>
  theme_minimal() +
  theme(panel.border = element_rect(color = "black", fill = NA),
        axis.text.x = element_text(size=12, hjust = 0.5, vjust = 0.5, angle=0),
        axis.title.x = element_text(size = 14, margin = margin(t = 10, r = 0, b = 0, l = 0)),
        axis.title.y = element_text(size = 14, margin = margin(t = 0, r = 10, b = 0, l = 0)),
        axis.text.y = element_text(size = 12),
        legend.position="none")+
  xlab("Chromosome length (bp)")+
  ylab("Number of miRNAs")
```

## Chromosome length versus number of miRNAs plot

```{r, out.width = "700px", echo=FALSE, fig.align="center"}
knitr::include_graphics("../docs/corr_plot.png")
```

## Working with networks/graphs - igraph library

```{r, eval=FALSE}
library("igraph")

# Create graph object from edge list:
mirna_graph <- graph_from_edgelist(as.matrix(mirna_target_data[,1:2]), 
                                   directed = F)

# Generate random graph with the same properties:
random_graph <- sample_gnm(n=length(c(mirna_target_data$MIRNA,   # number of vertices
                                      mirna_target_data$GENES)), 
                           m = nrow(mirna_target_data))          # number of edges

# Get the degree distribution data:
random_degree_dist <- data.frame(k=as.numeric(degree(random_graph))) %>% 
  group_by(k) %>%                 # edge number
  summarize(freq=n()) %>% 
  filter(k!=0) %>% 
  mutate(freq=freq/sum(freq)) %>% # calculate frequency (0-1)
  as.data.frame() 

mirna_degree_dist <- mirna_target_data %>% 
  group_by(MIRNA) %>% 
  summarize(k=n()) %>% 
  group_by(k) %>% 
  summarize(freq=n()) %>% 
  mutate(freq=freq/sum(freq)) %>% 
  as.data.frame()
```

## Visualize degree distribution - Plot

```{r, out.width = "900px", echo=FALSE, fig.align="center"}
knitr::include_graphics("../docs/degree_dist.png")
```

## Barplot - Second Y axis

```{r, eval=FALSE}
library("patchwork")

barplot <- ggplot(plot1_data_interactions, 
                  aes(x=factor(target_chr, level=level_order), 
                      y=norm_count))+
  geom_bar(stat="identity", fill="steelblue")+
  geom_point(data=plot1_data_mirnacount, 
             aes(x=factor(mirna_chr),
                 y=norm_count),
             color="red",
             size=4)+
  annotate(geom="text", label=paste0("corr. = ", as.character(round(cor, 2))), 
           x="chrX", y=350)+
  ### <b>
  scale_y_continuous(name = "Normalized target gene count",
                     sec.axis = sec_axis(~./100, 
                                         name="Normalized miRNA count"))+
  ### </b>
  theme_minimal()+
  theme(panel.border = element_rect(color = "black", fill = NA),
        axis.text.x = element_text(size=10, hjust = 0.5, vjust = 0.5, angle=90),
        axis.title.x = element_text(size = 14, margin = margin(t = 10, r = 0, b = 0, l = 0)),
        axis.title.y = element_text(size = 14, margin = margin(t = 0, r = 10, b = 0, l = 0)),
        axis.text.y = element_text(size = 12),
        axis.title.y.right = element_text(size=14,
                                          angle=90,
                                          margin = margin(t = 0, r = 0, b = 0, l = 10)))+
  xlab("Chromosome")
```

## Number of miRNA genes and targets by chromosome - Plot

```{r, out.width = "800px", echo=FALSE, fig.align="center"}
knitr::include_graphics("../docs/barplot_mirna_target_count.png")
```